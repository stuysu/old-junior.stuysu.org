function getSheetInfo(e){return{guide:document.getElementById(e+"-study-guide"),title:document.getElementById(e+"-sheet-title"),url:document.getElementById(e+"-sheet-url"),subject:document.getElementById(e+"-sheet-subject"),teacher:document.getElementById(e+"-sheet-teacher"),author:document.getElementById(e+"-sheet-author")}}async function updateSheet(e){const{title:t,url:r,subject:a,teacher:d,author:n}=getSheetInfo(e);let o=await sfetch("/api/sheets",{method:"PUT",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({id:e,title:t.value,url:r.value,subject:a.value,teacher:d.value,author:n.value})});o.error?alertManager.addAlert("Failure","received an error from the server","danger"):o.found?alertManager.addAlert("Success","updated study guide","primary"):alertManager.addAlert("","Entry not found","secondary")}async function removeSheet(e){const{guide:t}=getSheetInfo(e);t.remove();let r=await sfetch("/api/sheets/"+e,{method:"DELETE",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});r.id?!1===r.deleted?alertManager.addAlert("Failure","did not find a study sheet to delete","secondary"):alertManager.addAlert("Success","deleted study sheet","warning"):alertManager.addAlert("Failure","received error from server","danger")}async function addSheet(){const{url:e,title:t,subject:r,teacher:a,author:d}=getSheetInfo("add");let n=await sfetch("/api/sheets",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({url:e.value,title:t.value,subject:r.value,teacher:a.value,author:d.value})});if(n.created){console.log(n),addSheetToPage(n.id,n.url,n.title,n.subject,n.teacher,n.author);let e=getSheetInfo("add");for(const t in e)e[t].value="";alertManager.addAlert("Success","created study sheet!","success")}else alertManager.addAlert("Failure","failed to create study sheet","warning")}function addSheetToPage(e,t,r,a,d,n){const o=`\n      <div id="${e}-study-guide" class="glass sheet">\n        <input placeholder="Title..." type="text" class="form-input glass" value="${r}"\n          id="${e}-sheet-title" />\n        <input placeholder="Url..." type="text" class="form-input glass" value="${t}"\n          id="${e}-sheet-url" />\n        <input placeholder="Subject..." type="text" class="form-input glass" value="${a}"\n          id="${e}-sheet-subject" />\n        <input placeholder="Teacher..." type="text" class="form-input glass" value="${d}"\n          id="${e}-sheet-teacher" />\n        <input placeholder="Author..." type="text" class="form-input glass" value="${n}"\n          id="${e}-sheet-author" />\n\n        <button id="${e}-sheet-update" class="glass button"\n          onclick="updateSheet('${e}')">Update</button>\n        <button id="${e}-sheet-remove" class="glass button"\n          onclick="removeSheet('${e}')">Remove</button>\n\n        <div id="${e}-sheet-keywords">\n          <div id="add-keyword">\n            <input type="text" id="${e}-add-keyword-text" placeholder="Keyword..." class="form-input glass" />\n            <button id="${e}-add-keyword-add" class="glass button" onclick="addKeyword('${e}')">Add</button>\n          </div>\n        </div>\n      </div>\n    `;document.getElementById("study-sheets").innerHTML+=o}async function removeKeyword(e){document.getElementById(e+"-keyword").remove();let t=await sfetch("/api/sheets/keywords/"+e,{method:"DELETE",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});t.id?!1===t.deleted?alertManager.addAlert("Failure","did not find a keyword to delete","secondary"):alertManager.addAlert("Success","deleted keyword","warning"):alertManager.addAlert("Failure","received error from server","danger")}async function addKeyword(e){const t=document.getElementById(e+"-add-keyword-text").value;let r=await sfetch("/api/sheets/keywords",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({id:e,keyword:t})});r.error?alertManager.addAlert("Failure","received an error from the server","danger"):(addKeywordToPage(e,r.keyword,r.id),r.created?alertManager.addAlert("Success",`added keyword ${r.keyword}`,"success"):alertManager.addAlert("Failure","didn't create study sheet keyword","warning"))}function addKeywordToPage(e,t,r){const a=`<div id='${r}-keyword'><div><span id='${r}-keyword-text'>${t}</span></div><div><button id='${r}-keyword-remove' class='glass button' onclick="removeKeyword('${r}')">Remove</button></div></div>`;document.getElementById(`${e}-sheet-keywords`).innerHTML+=a}

const express=require("express"),{CreateError:CreateError,analyticsOn:analyticsOn,isMobile:isMobile,addModule:addModule}=require("../utils"),route=express.Router(),{Events:Events,sequelize:sequelize}=require("./../../models"),datefuncs=require("../datefuncs"),MAX_EVENTS=5,{getDayInfo:getDayInfo}=require("../scheduleutils");route.get("/",analyticsOn("Home Page",(async(e,t,s)=>{let o=await Events.findAll({order:sequelize.col("date")}),r=[],i=[];const a=Date.now();for(let e of o){const t=e.date-a;if(!e.isHidden&&t>0){(e.isImportant?i:r).push(e)}}let n=await getDayInfo();t.render("docs/",addModule({title:"Home",isHomepage:!0,page:"index",dayInfo:n,events:r,otherEvents:i,isMobile:isMobile(e)},datefuncs))}))),module.exports=route;

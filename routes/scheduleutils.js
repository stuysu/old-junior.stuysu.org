const{Calendar:Calendar}=require("./../models"),MAX_TIME={hours:16,minutes:30};function getWhereFromDate(e){let t=e.getMonth()+1,n=e.getFullYear();return{day:e.getDate(),year:n,month:t}}async function getDayInfo(e=new Date(Date.now())){e.setHours(e.getHours()-4);let t=await Calendar.findOne({where:getWhereFromDate(e)});if(null!==t&&(t.today=!0,(e.getHours()>MAX_TIME.hours||e.getHours()==MAX_TIME.hours&&e.getMinutes()>=MAX_TIME.minutes)&&(t=null)),null===t){let n=7;for(;null===t&&n-- >0;)e.setDate(e.getDate()+1),t=await Calendar.findOne({where:getWhereFromDate(e)});null!==t&&(t.today=!1)}return t}module.exports={getDayInfo:getDayInfo};
